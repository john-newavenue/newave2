<ul class="large-block-grid-3 small-block-grid-2 sortable-album-items" >
<%= f.semantic_fields_for :images do |item| %>
  <li class="item item-<%= item.object.id %>">
    <div class="tile light">
      <div class="draggable-handle vertical">Drag to Move</div>
      <div class="center-text"><%= image_tag item.object.attachment(:medium_square), :style => "width: 75%;" %></div>
      <ul>
        <%= item.input :title, :label => false, :placeholder => "Title" %>
        <%= item.input :description, :as => :text, :input_html => { :rows => 2 }, :label => false, :placeholder => "Description"  %>
        <%= item.input :tag_list, :label => "Tags, comma-separated", :input_html => { :rows => 2, :class => "taggable tagit", :value => item.object.tag_list } %>
        <label for="mark_for_deletion">
          <input type="checkbox"
            name="album[images_attributes][<%= item.index %>][mark_for_deletion]"
            id="album[images_attributes][<%= item.index %>][mark_for_deletion]"
          > Mark for Deletion
        </label>
        <%= item.input :position, :as => :hidden, :class => "item-position-input" %>
      </ul>

    </div>
  </li>
<% end %>
</ul>



<script>
$(document).ready( function () {

  $('.sortable-album-items').sortable({
    placeholder: "ui-state-highlight",
    forcePlaceholderSize: true,
    handle: ".draggable-handle",
    containment: ".sortable-album-items",
    stop: function() {
      $('.sortable-album-items input[id^="album_images_attributes_"][id$="_position"] ').each( function(index, elem) {
        $(elem).attr('value',index)
      })
    }
  })

  $('.taggable').tagit({
    caseSensitive: false,
    placeholderText : 'Type new tag'
  });

});
</script>

